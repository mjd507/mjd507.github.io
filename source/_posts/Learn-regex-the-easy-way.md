---
title: 了解正则的最佳姿势
categories: 
toc: true
comments: true
copyright: true
date: 2017-07-29 10:33:18
tags:
---

正则，简单来讲就是用来查找文本中符合特定模式的字符串的。它究竟有多实用，相信倒腾过爬虫的人都知道。抓取接口的时候，返回的多数是些 HTML 标签，这些对我们来讲是没有多大用处的，提取出标签内的内容才是关键，而通过正则表达式则能很好的进行筛选。

<!--more-->

假设一个网站的用户名成由小写字母，数字下划线和横杠组成，并且只能有3到15个字符，那么该如何写出这个正则表达式？

![](/images/regex_username.png)

## 基本匹配

文本直接按照正则表达式的字母和数字进行匹配。

```java
"cat" => The cat sat on the mat
```

正则表达式大小写敏感，所以 Cat 与 cat 不匹配。

```java
"Cat" => The cat sat on the Cat
```

## 元字符匹配

元字符不代表自己，是具有特殊意义的专用字符。一些**写在方括号内的元字符**还有特别的含义。

|  元字符  |                    含义                    |
| :---: | :--------------------------------------: |
|   ^   |                 匹配输入的开头                  |
|   $   |                 匹配输入的结尾                  |
|   .   |           匹配除换行符以外的任何**单个**字符            |
|   *   |            匹配前面的符号 **0次或多次**             |
|   +   |            匹配前面的符号 **1次或多次**             |
|   ?   |                 使前面的符号可选                 |
|   l   |          匹配符号之前的字符**或者**符号之后的字符          |
|   \   | 转义，允许你匹配保留字符，如  [ ] ( ) { } . * + ? ^ $ \ l |
| {m,n} |           匹配至少 m 个字符，最多 n 个字符            |
| (xyz) |            字符组，按照确定的顺序匹配 xyz             |
|  [ ]  |            字符类，匹配方括号之间的任何字符。             |
| [^ ]  |          非字符类。匹配不包含方括号之间字符的任何字符          |

到这里，能做的事情就比较多了。比如：

- 判断内容是否都是正数  `^[0-9]+$`
- 判断内容是否都是负数 `^-[0-9]+$`
- 判断内容是否是数字 `^-?[0-9]+$` 
- 判断内容是否都是小写字母 `^[a-z]+$`
- 判断内容是否都是大写字母 `^[A-Z]+$`

## 简写字符集

对于常用的字符集，正则表达式提供了简化的写法。

|  简写  |           含义           |
| :--: | :--------------------: |
|  \w  | 匹配字母数字下划线 [a-zA-Z0-9_] |
|  \W  |  匹配非字母数字下划线字符 [^ \w\]  |
|  \d  |       匹配数字 [0-9]       |
|  \D  |     匹配非数字 [^ \d\]      |
|  \s  |  匹配空格 [\t\n\f\r\p{Z}]  |
|  \S  |      匹配空格 [^ \s\]      |

在举几个常用的例子：

- 匹配手机号码 `^1\d{10}$`

  >     移动：134、135、136、137、138、139、147、150、151、152、157、158、159、178、182、183、184、187、188
  >     联通：130、131、132、145、155、156、175、176、185、186
  >     电信：133、153、173、177、180、181、189
  >     全球星：1349
  >     虚拟运营商：170

  `^((13[0-9])|(14[57])|(15[0-3|5-9])|(17[03|5-8])|(18[0-9]))\d{8}$`

- 匹配邮箱地址 

  > - 必须包含一个并且只有一个符号"@"           
  > - 允许"@"前的字符中出现"＋-."  
  > - 允许"@"后的字符出现"-."
  > - aaa.bbb.ccc.a+b-cddd@e.ee.hh.fff.c-om

  `\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*`

- 匹配链接

  > http://wx.tuhu.cn

  `^((http|https):\/\/)?[^\s]*$`

## 标识

一些标识也会影响正则匹配的输出，它们可以以任何顺序或组合使用，并且是RegExp的组成部分。

|  标识  |    含义    |
| :--: | :------: |
|  i   | 匹配不区分大小写 |
|  g   |   全局搜索   |
|  m   |   多行搜索   |

## 参考文章

[learn-regex](https://github.com/zeeshanu/learn-regex)

[正则表达式 -- MDN](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Regular_Expressions)

